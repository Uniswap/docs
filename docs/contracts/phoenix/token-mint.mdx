---
title: Token Mint
sidebar_position: 3
---
# UNI Minter

## Overview

The UNI token contract has a `mint` function, which is callable by the address defined as the `minter`. Since the token's deployment, Uniswap Governance has held the `minter` role. You can view the current `minter` [here](https://etherscan.io/address/0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984#readContract).

UNIMinter is designed to coordinate the minting and distribution of UNI tokens to one or more recipients when it has been granted the `minter` role. Please note the original `UNI` mint mechanics are still enforced:

1. Mints can only be performed once every 365 days
2. Mints are capped at 2% of the total UNI supply, inclusive of the supply held by `address(0xdead)` (the recipient of UNI on `Firepit.release()`)

UNIMinter's `owner` (Uniswap Governance) will be able to:

* Designate multiple recipients of minted tokens, with varying allocations
* Remove and revoke allocations, with a delay
* Appoint a new minting contract, replacing the current implementation

Altruistic actors will be responsible for:

* Minting & distributing tokens to the designated recipients
* Revoking allocations, after the delay period, for recipients that are no longer eligible for minted tokens

## Shares System

The UNIMinter contract implements a sophisticated shares-based allocation system that allows for proportional distribution of minted UNI tokens among multiple recipients.

### Share Structure

Each share allocation is represented by a `Share` struct containing:

- **`recipient`**: The address that will receive minted UNI tokens
- **`amount`**: The number of shares allocated (out of 10,000 total shares)
- **`revocationDelayDays`**: The number of days notice required for revocation
- **`pendingRevocationTime`**: Timestamp when revocation can be completed (0 if not pending)
- **`adjustedForRevocation`**: Whether the share has been adjusted for partial revocation

### Share Allocation Mechanics

- **Total Shares**: The system uses 10,000 shares to represent 100% of mintable tokens
- **Proportional Distribution**: When tokens are minted, they are distributed proportionally based on each recipient's share amount
- **Unallocated Shares**: Any unallocated shares result in reduced inflation, as only allocated shares participate in minting
- **Maximum Allocation**: The sum of all granted shares cannot exceed 10,000

### Granting Shares

The owner can grant shares to recipients using `grantShares()`:

```solidity
function grantShares(address _recipient, uint16 _amount, uint16 _revocationDelayDays)
```

- **`_recipient`**: Address to receive the allocation
- **`_amount`**: Number of shares to allocate (0-10,000)
- **`_revocationDelayDays`**: Days of notice required before revocation can be completed

## Revocation Dynamics

The UNIMinter implements a sophisticated revocation system that ensures fair treatment of recipients while allowing governance to adjust allocations over time.

### Revocation Process

The revocation process consists of two distinct phases:

1. **Initiation**: Owner calls `initiateRevokeShares()` to start the revocation process
2. **Completion**: Anyone can call `revokeShares()` after the delay period (defined in the `share` struct) to complete the revocation

### What Happens Between Initiation and Completion

After `initiateRevokeShares()` is called but before `revokeShares()` can be executed:

- **Share remains active**: The recipient continues to receive their full allocation from any mints that occur during this period
- **Pending revocation timestamp is set**: The contract calculates when revocation can be completed (`block.timestamp + revocationDelayDays * 1 days`)
- **No immediate effect**: The share allocation remains unchanged until `revokeShares()` is called
- **Anyone can complete**: Once the delay period expires, anyone can call `revokeShares()` to finalize the revocation

### Revocation Timing Logic

The contract implements intelligent timing logic based on when `revokeShares()` is called relative to the next mint:

#### Early Revocation (Before Next Mint)
If `revokeShares()` is called at a point greater than 365 days since the last time the `mint()` function was called but before anyone calls the `mint()` function:
- The share is **entirely removed** from the system
- The recipient receives no tokens from the next mint
- Total shares are reduced immediately

#### Partial Revocation (During Next Mint Period)
If `revokeShares()` is called after the next mint but before the subsequent mint:
- The share amount is **reduced proportionally** to the remaining time
- Example: If revocation occurs 90 days into a 365-day period, the recipient gets ~25% of their original allocation
- The share is marked as `adjustedForRevocation` to prevent double-adjustment

#### Invalid Revocation
If `revokeShares()` is called too early (before the delay period expires):
- The transaction reverts with `InvalidRevocation` error
- The recipient continues to receive their full allocation

### Example Scenario

Let's walk through a concrete example:

1. **Day 0**: Governance grants 1000 shares to Alice with a 30-day revocation delay
2. **Day 100**: Governance calls `initiateRevokeShares()` for Alice's allocation
   - Alice's `pendingRevocationTime` is set to Day 130 (100 + 30 days)
   - Alice continues to receive her full 1000-share allocation
3. **Day 120**: Next mint occurs - Alice receives tokens based on her full 1000 shares
4. **Day 130**: The delay period expires - anyone can now call `revokeShares()`
5. **Day 200**: Someone calls `revokeShares()` for Alice
   - Since this is after the mint (Day 120) but before the next mint period ends (Day 485), Alice gets a partial allocation
   - Her shares are reduced proportionally: `(485 - 200) / 365 * 1000 = ~780 shares`
   - Alice will receive ~78% of her original allocation in future mints

### Revocation Delay

Each share allocation includes a configurable revocation delay:
- Set when shares are granted via `grantShares()`
- Provides notice period before revocation can be completed
- Ensures recipients have time to adjust to allocation changes

## Governance Controls

The UNIMinter contract implements several governance controls that allow the owner (Uniswap Governance) to manage the minting system effectively.

### Owner Permissions

The contract owner has exclusive control over:

#### Share Management
- **`grantShares()`**: Allocate new shares to recipients
- **`initiateRevokeShares()`**: Start the revocation process for existing shares

#### Minter Role Management
- **`setMinter()`**: Transfer the UNI minter role to a new address
  - This is a critical operation that permanently transfers minting capability
  - Once transferred, this contract can no longer mint unless the role is transferred back

### Public Functions

Certain functions are callable by anyone to ensure the system operates fairly:

#### Minting
- **`mint()`**: Execute the annual mint and distribute tokens
  - Can be called by anyone once per year
  - Automatically distributes tokens proportionally to all active share holders
  - Respects the 2% annual inflation cap and 365-day minting period

#### Revocation Completion
- **`revokeShares()`**: Complete or update share revocations
  - Can be called by anyone after the delay period
  - Implements the intelligent timing logic described above
  - Ensures the system remains fair and transparent

### Security Considerations

- **Ownership Transfer**: The contract inherits from `Owned`, allowing governance to transfer ownership if needed
- **Role Separation**: The minter role can be transferred independently of contract ownership
- **Delay Mechanisms**: Revocation delays prevent sudden, unfair changes to allocations
- **Proportional Adjustments**: Partial revocations ensure recipients receive fair compensation for their time in the system